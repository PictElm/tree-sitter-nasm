{
  "name": "nasm",
  "rules": {
    "source_file": {
      "type": "REPEAT",
      "content": {
        "type": "CHOICE",
        "members": [
          {
            "type": "SYMBOL",
            "name": "source_line"
          },
          {
            "type": "PATTERN",
            "value": "\\r?\\n"
          }
        ]
      }
    },
    "source_line": {
      "type": "PREC",
      "value": 1,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "CHOICE",
            "members": [
              {
                "type": "SEQ",
                "members": [
                  {
                    "type": "CHOICE",
                    "members": [
                      {
                        "type": "SYMBOL",
                        "name": "label"
                      },
                      {
                        "type": "BLANK"
                      }
                    ]
                  },
                  {
                    "type": "CHOICE",
                    "members": [
                      {
                        "type": "SYMBOL",
                        "name": "instruction"
                      },
                      {
                        "type": "BLANK"
                      }
                    ]
                  }
                ]
              },
              {
                "type": "BLANK"
              }
            ]
          },
          {
            "type": "PATTERN",
            "value": "\\r?\\n"
          }
        ]
      }
    },
    "label": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "word"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": ":"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "instruction": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "instruction_prefix"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "known_instruction"
            },
            {
              "type": "SYMBOL",
              "name": "unknown_instruction"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "operands"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "instruction_prefix": {
      "type": "CHOICE",
      "members": [
        {
          "type": "PATTERN",
          "value": "[lL][oO][cC][kK]"
        },
        {
          "type": "PATTERN",
          "value": "[rR][eE][pP]"
        },
        {
          "type": "PATTERN",
          "value": "[rR][eE][pP][eE]"
        },
        {
          "type": "PATTERN",
          "value": "[rR][eE][pP][zZ]"
        },
        {
          "type": "PATTERN",
          "value": "[rR][eE][pP][nN][eE]"
        },
        {
          "type": "PATTERN",
          "value": "[rR][eE][pP][nN][zZ]"
        },
        {
          "type": "PATTERN",
          "value": "[xX][aA][cC][qQ][uU][iI][rR][eE]"
        },
        {
          "type": "PATTERN",
          "value": "[xX][rR][eE][lL][eE][aA][sS][eE]"
        },
        {
          "type": "PATTERN",
          "value": "[bB][nN][dD]"
        },
        {
          "type": "PATTERN",
          "value": "[nN][oO][bB][nN][dD]"
        },
        {
          "type": "PATTERN",
          "value": "[aA]16"
        },
        {
          "type": "PATTERN",
          "value": "[aA]32"
        },
        {
          "type": "PATTERN",
          "value": "[aA]64"
        },
        {
          "type": "PATTERN",
          "value": "[oO]16"
        },
        {
          "type": "PATTERN",
          "value": "[oO]32"
        },
        {
          "type": "PATTERN",
          "value": "[oO]64"
        },
        {
          "type": "PATTERN",
          "value": "[cC][sS]"
        },
        {
          "type": "PATTERN",
          "value": "[dD][sS]"
        },
        {
          "type": "PATTERN",
          "value": "[sS][sS]"
        },
        {
          "type": "PATTERN",
          "value": "[eE][sS]"
        },
        {
          "type": "PATTERN",
          "value": "[fF][sS]"
        },
        {
          "type": "PATTERN",
          "value": "[gG][sS]"
        }
      ]
    },
    "operands": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "operand"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": ","
              },
              {
                "type": "SYMBOL",
                "name": "operand"
              }
            ]
          }
        }
      ]
    },
    "operand": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "operand_prefix"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "register"
            },
            {
              "type": "SYMBOL",
              "name": "effective_address"
            },
            {
              "type": "SYMBOL",
              "name": "constant"
            },
            {
              "type": "SYMBOL",
              "name": "expression"
            }
          ]
        }
      ]
    },
    "operand_prefix": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": "strict"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "PATTERN",
              "value": "[bB][yY][tT][eE]"
            },
            {
              "type": "PATTERN",
              "value": "[wW][oO][rR][dD]"
            },
            {
              "type": "PATTERN",
              "value": "[dD][wW][oO][rR][dD]"
            },
            {
              "type": "PATTERN",
              "value": "[qQ][wW][oO][rR][dD]"
            },
            {
              "type": "PATTERN",
              "value": "[tT][wW][oO][rR][dD]"
            },
            {
              "type": "PATTERN",
              "value": "[oO][wW][oO][rR][dD]"
            },
            {
              "type": "PATTERN",
              "value": "[yY][wW][oO][rR][dD]"
            },
            {
              "type": "PATTERN",
              "value": "[zZ][wW][oO][rR][dD]"
            }
          ]
        }
      ]
    },
    "register": {
      "type": "CHOICE",
      "members": [
        {
          "type": "PATTERN",
          "value": "[aA][lL]"
        },
        {
          "type": "PATTERN",
          "value": "[aA][hH]"
        },
        {
          "type": "PATTERN",
          "value": "[cC][lL]"
        },
        {
          "type": "PATTERN",
          "value": "[cC][hH]"
        },
        {
          "type": "PATTERN",
          "value": "[dD][lL]"
        },
        {
          "type": "PATTERN",
          "value": "[dD][hH]"
        },
        {
          "type": "PATTERN",
          "value": "[bB][lL]"
        },
        {
          "type": "PATTERN",
          "value": "[bB][hH]"
        },
        {
          "type": "PATTERN",
          "value": "[sS][pP][lL]"
        },
        {
          "type": "PATTERN",
          "value": "[bB][pP][lL]"
        },
        {
          "type": "PATTERN",
          "value": "[sS][iI][lL]"
        },
        {
          "type": "PATTERN",
          "value": "[dD][iI][lL]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]8[bB]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]9[bB]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]10[bB]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]11[bB]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]12[bB]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]13[bB]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]14[bB]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]15[bB]"
        },
        {
          "type": "PATTERN",
          "value": "[aA][xX]"
        },
        {
          "type": "PATTERN",
          "value": "[cC][xX]"
        },
        {
          "type": "PATTERN",
          "value": "[dD][xX]"
        },
        {
          "type": "PATTERN",
          "value": "[bB][xX]"
        },
        {
          "type": "PATTERN",
          "value": "[sS][pP]"
        },
        {
          "type": "PATTERN",
          "value": "[bB][pP]"
        },
        {
          "type": "PATTERN",
          "value": "[sS][iI]"
        },
        {
          "type": "PATTERN",
          "value": "[dD][iI]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]8[wW]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]9[wW]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]10[wW]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]11[wW]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]12[wW]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]13[wW]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]14[wW]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]15[wW]"
        },
        {
          "type": "PATTERN",
          "value": "[eE][aA][xX]"
        },
        {
          "type": "PATTERN",
          "value": "[eE][cC][xX]"
        },
        {
          "type": "PATTERN",
          "value": "[eE][dD][xX]"
        },
        {
          "type": "PATTERN",
          "value": "[eE][bB][xX]"
        },
        {
          "type": "PATTERN",
          "value": "[eE][sS][pP]"
        },
        {
          "type": "PATTERN",
          "value": "[eE][bB][pP]"
        },
        {
          "type": "PATTERN",
          "value": "[eE][sS][iI]"
        },
        {
          "type": "PATTERN",
          "value": "[eE][dD][iI]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]8[dD]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]9[dD]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]10[dD]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]11[dD]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]12[dD]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]13[dD]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]14[dD]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]15[dD]"
        },
        {
          "type": "PATTERN",
          "value": "[rR][aA][xX]"
        },
        {
          "type": "PATTERN",
          "value": "[rR][cC][xX]"
        },
        {
          "type": "PATTERN",
          "value": "[rR][dD][xX]"
        },
        {
          "type": "PATTERN",
          "value": "[rR][bB][xX]"
        },
        {
          "type": "PATTERN",
          "value": "[rR][sS][pP]"
        },
        {
          "type": "PATTERN",
          "value": "[rR][bB][pP]"
        },
        {
          "type": "PATTERN",
          "value": "[rR][sS][iI]"
        },
        {
          "type": "PATTERN",
          "value": "[rR][dD][iI]"
        },
        {
          "type": "PATTERN",
          "value": "[rR]8"
        },
        {
          "type": "PATTERN",
          "value": "[rR]9"
        },
        {
          "type": "PATTERN",
          "value": "[rR]10"
        },
        {
          "type": "PATTERN",
          "value": "[rR]11"
        },
        {
          "type": "PATTERN",
          "value": "[rR]12"
        },
        {
          "type": "PATTERN",
          "value": "[rR]13"
        },
        {
          "type": "PATTERN",
          "value": "[rR]14"
        },
        {
          "type": "PATTERN",
          "value": "[rR]15"
        }
      ]
    },
    "effective_address": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "["
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "PATTERN",
                  "value": "[bB][yY][tT][eE]"
                },
                {
                  "type": "PATTERN",
                  "value": "[wW][oO][rR][dD]"
                },
                {
                  "type": "PATTERN",
                  "value": "[dD][wW][oO][rR][dD]"
                },
                {
                  "type": "PATTERN",
                  "value": "[nN][oO][sS][pP][lL][iI][tT]"
                },
                {
                  "type": "PATTERN",
                  "value": "[rR][eE][lL]"
                },
                {
                  "type": "PATTERN",
                  "value": "[aA][bB][sS]"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "expression"
        },
        {
          "type": "STRING",
          "value": "]"
        }
      ]
    },
    "constant": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "constant_numeric"
        },
        {
          "type": "SYMBOL",
          "name": "constant_charstr"
        },
        {
          "type": "SYMBOL",
          "name": "constant_floatpt"
        }
      ]
    },
    "constant_numeric": {
      "type": "PATTERN",
      "value": "[0-9]+"
    },
    "constant_charstr": {
      "type": "CHOICE",
      "members": [
        {
          "type": "PATTERN",
          "value": "\"[^']*\""
        },
        {
          "type": "PATTERN",
          "value": "'[^\"]*'"
        },
        {
          "type": "PATTERN",
          "value": "`[^`]*`"
        }
      ]
    },
    "constant_floatpt": {
      "type": "PATTERN",
      "value": "[0-9]+\\.[0-9]*"
    },
    "known_instruction": {
      "type": "CHOICE",
      "members": [
        {
          "type": "PATTERN",
          "value": "[mM][oO][vV]"
        },
        {
          "type": "PATTERN",
          "value": "[aA][dD][dD]"
        },
        {
          "type": "PATTERN",
          "value": "[iI][nN][cC]"
        },
        {
          "type": "PATTERN",
          "value": "[sS][yY][sS][cC][aA][lL][lL]"
        },
        {
          "type": "PATTERN",
          "value": "[sS][cC][aA][sS][bB]"
        }
      ]
    },
    "unknown_instruction": {
      "type": "SYMBOL",
      "name": "word"
    },
    "comment": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": ";"
        },
        {
          "type": "PATTERN",
          "value": ".*\\r?\\n"
        }
      ]
    },
    "word": {
      "type": "PREC",
      "value": -5,
      "content": {
        "type": "PATTERN",
        "value": "[A-Za-z._?$][A-Za-z0-9_$#@~.?]*"
      }
    },
    "expression": {
      "type": "SYMBOL",
      "name": "word"
    }
  },
  "extras": [
    {
      "type": "SYMBOL",
      "name": "comment"
    },
    {
      "type": "PATTERN",
      "value": "\\s|\\\\\\r?\\n"
    }
  ],
  "conflicts": [
    [
      "label",
      "unknown_instruction"
    ]
  ],
  "precedences": [],
  "externals": [],
  "inline": [],
  "supertypes": []
}

